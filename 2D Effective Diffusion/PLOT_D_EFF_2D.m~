function [] = PLOT_D_EFF_2D( u1,p,t,tspan )
%PLOT_CIRCLE_SQUARE_SYSTEM - plots the solution of the TMZ diffusion
%problem

u1 = zeros(size(p,2),length(tspan));

%CREATE SOLUTION MOVIES
% fig = figure(2);
% u = fig.Units;
% fig.Units = 'normalized';
% % fig.Position = [0.3 0.3 0.7 0.7];
% fig.Color = [1 1 1];


F1 = pdeInterpolant(p,t,u1);

xgrid = -3:0.01:3;
ygrid = -3:0.01:3;
[X,Y] = meshgrid(xgrid,ygrid);

uout1 = evaluate(F1,X,Y);

% colormap(cool);
for i = 1:length(tspan)
    fig = figure(2);
    u = fig.Units;
    fig.Units = 'normalized';
    fig.Color = [1 1 1];
    colormap(cool);
%     subplot(2,2,1)
    Z1 = reshape(uout1(:,i),size(X));
    surf(xgrid,ygrid,Z1);
    axis([-0.5 0.5 -0.5 0.5 -0.01 1.01]);
    title('Temozolomide');
    zlabel('Concentration');
    shading interp;

    
    fig3 = figure(3);
    u = fig3.Units;
    fig3.Units = 'normalized';
    % fig3.Position = [0.3 0.3 0.7 0.7];
    fig3.Color = [1 1 1];
    colormap(cool);
%     subplot(2,2,2)
umax = max(max(u12));
umin = min(min(u12));
    Z2 = reshape(uout2(:,i),size(X));
    surf(xgrid,ygrid,Z2);
    axis([-0.5 0.5 -0.5 0.5 -0.01 0.3]);
    title('Active drug');
    zlabel('Concentration');
    shading interp;
    
    
    fig4 = figure(4);
    u = fig4.Units;
    fig4.Units = 'normalized';
    % fig4.Position = [0.3 0.3 0.7 0.7];
    fig4.Color = [1 1 1];
    colormap(cool);
%     subplot(2,2,3)
umax = max(max(u13));
umin = min(min(u13));
    Z3 = reshape(uout3(:,i),size(X));
    surf(xgrid,ygrid,Z3);
    axis([-0.5 0.5 -0.5 0.5 -0.001 0.051]);
    title('pH');
    zlabel('Concentration');
    shading interp;
%     pause(0.001)
    pause
end

end



